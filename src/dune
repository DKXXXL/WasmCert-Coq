(executable
  (name wasm_interpreter)
  (libraries cmdliner linenoise)
  (modes (best exe)))

(install
  (package wasm_interpreter)
  (section bin)
  (files (wasm_interpreter.exe as wasm_interpreter)))

(rule
	(targets "extract.ml" "extract.mli")
	(deps "../theories/extraction.vo")
	(action
		(progn
			(run cp "../theories/extract.ml" "../theories/extract.mli" "./")
			; What follows are dirty tricks to try to fix Coq’s output and make it accepted by OCaml… but they don’t work as expected.
			; TODO: Just provide a patch.
			; (run sed "-ie" "s/Coq__5/Coq__3/g" "extract.ml")
			; (run rm "extract.mli")
		)))

(env (dev (flags (:standard -warn-error -A -w -39 -w -50)))) ; The extracted OCaml code yields a lot of warnings.

